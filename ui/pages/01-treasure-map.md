# 寻宝地图

## 用途

主页面，用户遛狗时发现并开启宝箱的核心交互界面。属于底部 Tab 栏"寻宝"入口。全屏地图上展示附近宝箱，用户进入 50m 范围后手动开箱获取奖励。同时承载每日任务系统、世界消息和运营活动入口。

## 导航

- **来源：** 底部 Tab 栏"寻宝"
- **去向：** 我的积分（状态栏积分区域）、我的券包（状态栏券包图标）、券详情（商家券奖励"查看详情"）、运营活动页（活动按钮）

## 元素

### 顶部状态栏（浮层）
- 系统安全区下方，左右 16px，高 44px
- 毛玻璃效果（白色 80%，backdrop-blur 12px），圆角 12px，阴影 md
- 低端机降级：白色 92% 纯色背景，无模糊
- 左：金币图标 + "今日 +{n} 分"
- 中："3/10" 宝箱进度
- 右：券包图标 🎫 + 红点提示

### 跑马灯（世界消息）
- 紧贴状态栏下方，左右 16px，高 28px
- 半透明黑底 rgba(0,0,0,0.5)，圆角 8px，backdrop-blur 8px
- 低端机降级：rgba(0,0,0,0.6) 纯色，无模糊
- 左侧固定 🎉 图标，文字从右向左匀速滚动（~50px/s）
- 消息类型：开箱播报 / 商家券播报 / 任务完成 / 运营公告
- 每条间隔 2 秒，无消息时隐藏
- 运营公告类型可点击跳转活动页

### 提示条（条件触发）
- 紧贴跑马灯下方（无跑马灯时紧贴状态栏），左右 16px，高 36px，圆角 8px
- 三种类型：警告（GPS 弱 #FFF3CD）、错误（网络异常 #F8D7DA）、信息（宝箱被抢 #D1ECF1）
- 信息类 3 秒自动消失，其他持续到状态恢复

### 地图区域
- 全屏，Apple Maps 视觉风格
- 街道级别比例（约 300-500m 可视范围）
- 浅色底图：浅灰白底色（约 #F5F5F0），柔和的绿色公园/植被区域，浅灰道路，细线建筑轮廓
- 道路分级：主干道稍宽偏白，次干道/小路更细更灰
- 地标文字标注风格同 Apple Maps（小号、高对比、无衬线）
- 用户位置标记：40×40 蓝色圆 + 🐕 + 脉冲环

### 宝箱标记（7 种状态 + 任务宝箱）
- 积分宝箱常态：📦 28px，下方距离标注
- 积分宝箱可开启（50m 内）：📦 28px，弹跳动画 + 金色光晕，"可开启"绿色标注
- 积分宝箱变灰：28px，灰度 50% 不透明度
- 商家宝箱常态：🎁 34px
- 商家宝箱可开启：🎁 34px，弹跳 + 金色光晕
- 商家宝箱已领取：🎁 34px，灰度 + 绿色勾
- 稀有宝箱：对应类型图标 + 紫色光环脉冲（1.5s 周期）
- 任务宝箱：🎯 34px，外圈项圈色光环脉冲，下方"任务奖励"标注
- 入场动画：依次蹦出（scale 0→1，80ms 间隔，每个 0.4s）

### 筛选按钮
- 左下角胶囊，36px 高，"⚙️ 筛选"
- 展开下拉：全部 / 积分宝箱 / 商家宝箱

### 定位按钮
- 右下角 44×44 圆形，📍
- 按下时项圈色涟漪扩散（0.4s）

### 活动按钮（条件显示）
- 定位按钮正上方，间距 12px，44×44 圆形
- 白色背景，🎉 图标，外圈项圈色光环脉冲
- 有新活动时右上角红点 8×8
- 无活动期间完全隐藏
- 入场动画：右侧滑入（0.3s）+ 弹跳（0.2s）
- 点击跳转运营活动 H5

### 任务条
- Tab 栏正上方，左右 16px，底距 12px，高 44px
- 白色 90% 不透明度，backdrop-blur 12px，圆角 12px，阴影 md
- 低端机降级：白色 95% 纯色，无模糊
- 🐾 图标用项圈色，底部 3px 进度条用项圈色（0.3s 平滑过渡）
- 三种状态：
  - 未开始："🐾 今日寻宝任务 ▸"
  - 进行中："🐾 1/3 进行中  最近: 东北230m"
  - 全部完成："🎯 任务完成！领取奖励宝箱"（项圈色光环脉冲）
- 点击展开任务卡片

### 任务卡片（Bottom Sheet）
- 从底部滑出，约屏幕 1/3 高度
- 白色背景，顶部圆角 16px，拖拽条（36×4px，#F0F0F0）
- 半透明遮罩 rgba(0,0,0,0.3)
- 标题"今日寻宝任务" + 右上角进度 "1/3"（项圈色）
- 3 个任务项：复选框（项圈色填充）+ 任务名 + 实时进度 + 奖励
- "出发"按钮（仅未开始时）：项圈色渐变背景，白字，圆角 24px
- 关闭：点击遮罩 / 下滑拖拽

### 开箱动画
- 0.8s 开盖动画 + 金色粒子爆散
- 稀有宝箱额外粒子密度
- 任务宝箱粒子颜色跟随项圈色
- 动画期间地图交互锁定

### 积分奖励卡片（Bottom Sheet）
- 底部滑出，屏幕 1/4 高度
- 金币图标 48×48 + "+{n} 积分" 32px 金色（DIN Alternate 字体）+ 总积分提示

### 商家券奖励卡片（Bottom Sheet）
- 底部滑出，屏幕 1/3 高度
- 商家 logo + 名称 + 券面信息 24px 红色（DIN Alternate 数字）+ 有效期 + 额外积分标签
- "查看详情"主按钮 + "关闭"文字按钮

### 底部 Tab 栏
- 56px 高 + 平台安全区
- 4 个 Tab：🏠首页、📦寻宝（选中）、🗺️轨迹、👤我的

## 状态

- **默认：** 地图加载完成，显示附近宝箱，任务条显示当日任务状态
- **加载中：** 地图加载骨架屏，宝箱延迟出现（依次蹦出动画）
- **任务完成：** 任务条光环脉冲 + toast "🎉 今日任务全部完成！" + 触觉反馈
- **任务宝箱出现：** 🎯 标记出现在用户附近，项圈色光环
- **空状态：** 1km 内无宝箱 → 居中插画 + "附近暂无宝箱，换个地方遛遛看"
- **错误 — GPS 弱：** 提示条持续显示"GPS 信号弱，请移至空旷处"
- **错误 — 网络异常：** 提示条持续显示 + "重试"按钮
- **错误 — 定位未授权：** 全屏引导页，插画 + "寻宝需要定位权限" + "去设置"按钮
- **城市未开放：** 居中插画 + "当前区域暂未开放寻宝，敬请期待"

## 设计风格

PawQuest 自定义品牌设计系统。全屏 Apple Maps 风格地图为主体，所有 UI 元素以毛玻璃浮层覆盖其上（低端机降级为半透明纯色），营造沉浸式探索感。视觉基调轻盈圆润——大圆角、柔和阴影、暖白表面。宝箱通过弹跳、发光、粒子等微动画传递"可交互"和"奖励"的反馈。项圈色作为个性化视觉线索贯穿任务条、活动按钮和任务宝箱。整体克制，不喧宾夺主于地图本身。iOS 与 Android 视觉完全统一，仅导航交互跟随平台惯例。
